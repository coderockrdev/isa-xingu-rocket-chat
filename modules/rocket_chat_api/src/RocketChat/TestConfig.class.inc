<?php
/**
 * Created by PhpStorm.
 * User: lawri
 * Date: 6/25/17
 * Time: 3:41 PM
 */

namespace RocketChat {

  class Test7Config extends Drupal8Config {

    private $userId;
    private $userToken;
    private $server = "http://127.0.0.1:3000";

    /**
     * Retrieves the Storage from a Drupal 7 Variables container
     * @param String $ElementName
     *   Name of the Variable to get.
     * @param String $Default
     *   A Optional default for when none is found.
     *
     * @return string
     *   The value stored or the default or NUll.
     */
    function getElement($ElementName, $Default = NULL) {
      switch($ElementName) {
        case "rocket_chat_uid": return $this->userId;
        case "rocket_chat_uit": return $this->userToken;
        case "rocket_chat_url": return $this->server;
        default : return $Default;
      }
    }

    function getJsonDecoder() {
      return parent::getJsonDecoder(); // TODO: Change the autogenerated stub
    }

    /**
     * @param String $ElementName
     *  Key value to set in the Config Backend.
     * @param String $newValue
     *  the new Value to store.
     *
     * @return void
     */
    function setElement($ElementName, $newValue) {
      switch($ElementName) {
        case "rocket_chat_uid": $this->userId = $newValue;
                                break;
        case "rocket_chat_uit": $this->userToken = $newValue;
                                break;
        case "rocket_chat_url": $this->server = $newValue;
                                break;
        default : fwrite(STDERR,"TEST SET [$ElementName=>$newValue]\n");
      }
    }

    /**
     * is this a Debug / verbose Run.
     *
     * @return boolean
     */
    function isDebug() {
      return FALSE;//TRUE;
    }

    /**
     * @param String $message
     *   Message to report back.
     * @param String $type
     *   Type or Level of the Message
     *
     * @return mixed
     */
    function notify($message, $type) {
      return fwrite(STDERR,"Message [$type=>$message]\n");
    }
  }
}

namespace {
  function drupal_json_decode($json) {
    return \GuzzleHttp\json_decode($json, TRUE);
  }
}

